<HTML
><HEAD
><TITLE
>ifx_query</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.41"><LINK
REL="HOME"
TITLE="PHP3 Manual"
HREF="manual.html"><LINK
REL="UP"
TITLE="Informix functions"
HREF="ref.ifx.html"><LINK
REL="PREVIOUS"
TITLE="ifx_close"
HREF="function.ifx-close.html"><LINK
REL="NEXT"
TITLE="ifx_prepare"
HREF="function.ifx-prepare.html"></HEAD
><BODY
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PHP3 Manual</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="function.ifx-close.html"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="function.ifx-prepare.html"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><H1
><A
NAME="FUNCTION.IFX-QUERY"
>ifx_query</A
></H1
><DIV
CLASS="REFNAMEDIV"
><A
NAME="AEN11357"
></A
>ifx_query -- Send Informix query</DIV
><DIV
CLASS="REFSECT1"
><A
NAME="AEN11360"
></A
><H2
>Description</H2
><DIV
CLASS="FUNCSYNOPSIS"
><P
></P
><CODE
CLASS="FUNCDEF"
>int ifx_query</CODE
>(string query, int [<SPAN
CLASS="OPTIONAL"
>link_identifier</SPAN
>]
                   , int [<SPAN
CLASS="OPTIONAL"
>cursor_type</SPAN
>]
                   , mixed [<SPAN
CLASS="OPTIONAL"
>blobidarray</SPAN
>]
                   );<P
></P
></DIV
><P
> 
     Returns: A positive Informix result identifier on success, or
     false on error.  
    </P
><P
> 
     An integer "result_id" used by other functions to retrieve the
     query results.  Sets "affected_rows" for retrieval by the
     <A
HREF="function.ifx-affected-rows.html"
><B
CLASS="FUNCTION"
>ifx_affected_rows()</B
></A
> function.
    </P
><P
> 
     <B
CLASS="FUNCTION"
>ifx_query()</B
> sends a query to the currently
     active database on the server that's associated with the
     specified link identifier.  If the link identifier isn't
     specified, the last opened link is assumed.  If no link is open,
     the function tries to establish a link as if
     <A
HREF="function.ifx-connect.html"
><B
CLASS="FUNCTION"
>ifx_connect()</B
></A
> was called, and use it.
    </P
><P
>     Executes <TT
CLASS="PARAMETER"
><I
>query</I
></TT
> on connection
     <TT
CLASS="PARAMETER"
><I
>conn_id</I
></TT
>. For "select-type" queries a cursor
     is declared and opened. The optional <TT
CLASS="PARAMETER"
><I
>cursor_type</I
></TT
>
     parameter allows you to make this a "scroll" and/or "hold"
     cursor.  It's a mask and can be either IFX_SCROLL, IFX_HOLD, or both
     or'ed together. Non-select queries are "execute immediate".
    </P
><P
>     For either query type the number of (estimated or real) affected
     rows is saved for retrieval by <A
HREF="function.ifx-affected-rows.html"
><B
CLASS="FUNCTION"
>ifx_affected_rows()</B
></A
>.
    </P
><P
>     If you have BLOB (BYTE or TEXT) columns in an update query, you
     can add a <TT
CLASS="PARAMETER"
><I
>blobidarray</I
></TT
> parameter containing
     the corresponding "blob ids", and you should replace those
     columns with a "?" in the query text.
    </P
><P
>     If the contents of the TEXT (or BYTE) column allow it, you can
     also use "ifx_textasvarchar(1)" and "ifx_byteasvarchar(1)".  This
     allows you to treat TEXT (or BYTE) columns just as if they were
     ordinary (but long) VARCHAR columns for select queries, and you
     don't need to bother with blob id's.
    </P
><P
>     With ifx_textasvarchar(0) or ifx_byteasvarchar(0) (the default
     situation), select queries will return BLOB columns as blob id's
     (integer value).  You can get the value of the blob as a string
     or file with the blob functions (see below).
    </P
><P
>     See also:  
     <A
HREF="function.ifx-connect.html"
><B
CLASS="FUNCTION"
>ifx_connect()</B
></A
>.
     <TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
CLASS="EXAMPLE"
><TR
><TD
><DIV
CLASS="EXAMPLE"
><P
><B
>Example 1. Show all rows of the "orders" table as a html table</B
></P
><PRE
CLASS="PROGRAMLISTING"
>ifx_textasvarchar(1);      // use "text mode" for blobs
$res_id = ifx_query("select * from orders", $conn_id);
if (! $res_id) {
    printf("Can't select orders : %s\n&lt;br&#62;%s&lt;br&#62;\n", ifx_error());
    ifx_errormsg();
    die;
}
ifx_htmltbl_result($res_id, "border=\"1\"");
ifx_free_result($res_id);
      </PRE
></DIV
></TD
></TR
></TABLE
>
     <TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
CLASS="EXAMPLE"
><TR
><TD
><DIV
CLASS="EXAMPLE"
><P
><B
>Example 2. Insert some values into the "catalog" table</B
></P
><PRE
CLASS="PROGRAMLISTING"
>                      // create blob id's for a byte and text column
$textid = ifx_create_blob(0, 0, "Text column in memory");
$byteid = ifx_create_blob(1, 0, "Byte column in memory");
                      // store blob id's in a blobid array
$blobidarray[] = $textid;
$blobidarray[] = $byteid;
                      // launch query
$query = "insert into catalog (stock_num, manu_code, " .
         "cat_descr,cat_picture) values(1,'HRO',?,?)";
$res_id = ifx_query($query, $conn_id, $blobidarray);
if (! $res_id) {
  ... error ...
}
                     // free result id
ifx_free_result($res_id);
      </PRE
></DIV
></TD
></TR
></TABLE
>
   </P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="function.ifx-close.html"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="manual.html"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="function.ifx-prepare.html"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>ifx_close</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="ref.ifx.html"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>ifx_prepare</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>
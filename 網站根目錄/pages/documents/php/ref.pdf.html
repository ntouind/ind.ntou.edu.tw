<HTML
><HEAD
><TITLE
>PDF functions</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.41"><LINK
REL="HOME"
TITLE="PHP3 Manual"
HREF="manual.html"><LINK
REL="UP"
TITLE="Function Reference"
HREF="funcref.html"><LINK
REL="PREVIOUS"
TITLE="Pattern Syntax"
HREF="pcre.pattern.syntax.html"><LINK
REL="NEXT"
TITLE="PDF_get_info"
HREF="function.pdf-get-info.html"></HEAD
><BODY
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PHP3 Manual</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="pcre.pattern.syntax.html"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="function.pdf-get-info.html"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="REFERENCE"
><A
NAME="REF.PDF"
></A
><DIV
CLASS="TITLEPAGE"
><H1
CLASS="TITLE"
>XLI. PDF functions</H1
><DIV
CLASS="PARTINTRO"
><A
NAME="AEN17948"
></A
><P
>    You can use the PDF functions in PHP to create PDF files if you
    have the PDF library by Thomas Merz (available at <A
HREF="http://www.ifconnection.de/~tm/"
TARGET="_top"
>http://www.ifconnection.de/~tm/</A
>).
    Please consult the excelent documentation for
    pdflib shipped with the source distribution of pdflib or available at
    <A
HREF="http://www.ifconnection.de/~tm/software/pdflib/PDFlib-0.6.pdf"
TARGET="_top"
>http://www.ifconnection.de/~tm/software/pdflib/PDFlib-0.6.pdf</A
>.
    It provides a very good overview of what pdflib capable of doing.
    Most of the functions in pdflib
    and the PHP module have the same name. The parameters are also
    identical.  You should also understand some of the concepts of PDF
    or Postscript to efficiently use this module.
    All lengths and coordinates are measured in Postscript points.
    There are generally 72 PostScript points to an inch, but this
    depends on the output resolution.

   </P
><P
>    There is another PHP module for pdf document creation based on
    FastIO's ClibPDF. It has a slightly different API. Check the
    <A
HREF="ref.cpdf.html"
>ClibPDF functions</A
> section for
    details.

   </P
><P
>    Currently two versions of pdflib are supported: 0.6 and 2.0. It
    is recommended that you use the newer version since it has more
    features and fixes some problems which required a patch for the old
    version. Unfortunately, the changes of the pdflib API in 2.0 have
    been so severe that even some PHP functions had to be altered. Here
    is a list of changes:
   
    </P
><P
></P
><UL
><LI
><P
>      The Info structure does not exist anymore. Therefore the function
      <A
HREF="function.pdf-get-info.html"
><B
CLASS="FUNCTION"
>pdf_get_info()</B
></A
> is obsolete and the functions
      <A
HREF="function.pdf-set-info-creator.html"
><B
CLASS="FUNCTION"
>pdf_set_info_creator()</B
></A
>,
      <A
HREF="function.pdf-set-info-title.html"
><B
CLASS="FUNCTION"
>pdf_set_info_title()</B
></A
>,
      <A
HREF="function.pdf-set-info-author.html"
><B
CLASS="FUNCTION"
>pdf_set_info_author()</B
></A
>,
      <A
HREF="function.pdf-set-info-subject.html"
><B
CLASS="FUNCTION"
>pdf_set_info_subject()</B
></A
> and
      <A
HREF="function.pdf-set-info-keywords.html"
><B
CLASS="FUNCTION"
>pdf_set_info_keywords()</B
></A
> do not take the
      info structure as the first parameter but the pdf document. This
      also means that the pdf document must be opened before these functions
      can be called.
     </P
></LI
><LI
><P
> 
      The way a new document is opened has changed. The function
      <A
HREF="function.pdf-open.html"
><B
CLASS="FUNCTION"
>pdf_open()</B
></A
> takes only one parameter which is
      the file handle of a file opened with <A
HREF="function.fopen.html"
><B
CLASS="FUNCTION"
>fopen()</B
></A
>.
     </P
></LI
></UL
><P
> 
    The pdf module introduces two new types of variables (if pdflib 2.0
    is used it is only one new type). They are called
    <TT
CLASS="PARAMETER"
><I
>pdfdoc</I
></TT
> and <TT
CLASS="PARAMETER"
><I
>pdfinfo</I
></TT
>
    (<TT
CLASS="PARAMETER"
><I
>pdfinfo</I
></TT
> is not existent if pdflib 2.0 is used. 
    <TT
CLASS="PARAMETER"
><I
>pdfdoc</I
></TT
> is a pointer to a pdf document and
    almost all functions need it as its first parameter.
    <TT
CLASS="PARAMETER"
><I
>pdfinfo</I
></TT
> contains meta data about the PDF
    document. It has to be set before <A
HREF="function.pdf-open.html"
><B
CLASS="FUNCTION"
>pdf_open()</B
></A
> is
    called.

   </P
><P
>    In order to output text into a PDF document you will need to provide
    the afm file for each font. Afm files contain font metrics for a
    Postscript font. By default these afm files are searched
    for in a directory named 'fonts' relative to the directory where the
    PHP script is located. (Again, this was true for pdflib 0.6, newer
    versions do not not neccessarily need the afm files.)

   </P
><P
>    Most of the functions are fairly easy to use. The most difficult part
    is probably to create a very simple pdf document at all. The following
    example should help to get started. It uses the PHP functions for
    pdflib 0.6. It creates the file test.pdf
    with one page. The page contains the text "Times-Roman" in an
    outlined 30pt font. The text is also underlined.
     </P
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
CLASS="EXAMPLE"
><TR
><TD
><DIV
CLASS="EXAMPLE"
><P
><B
>Example 1. Creating a PDF document with pdflib 0.6</B
></P
><PRE
CLASS="PROGRAMLISTING"
>&lt;?php
$fp = fopen("test.pdf", "w");
$info = PDF_get_info();
pdf_set_info_author($info, "Uwe Steinmann");
PDF_set_info_title($info, "Test for PHP wrapper of PDFlib 0.6");
PDF_set_info_author($info, "Name of Author");
pdf_set_info_creator($info, "See Author");
pdf_set_info_subject($info, "Testing");
$pdf = PDF_open($fp, $info);
PDF_begin_page($pdf, 595, 842);
PDF_add_outline($pdf, "Page 1");
pdf_set_font($pdf, "Times-Roman", 30, 4);
pdf_set_text_rendering($pdf, 1);
PDF_show_xy($pdf, "Times Roman outlined", 50, 750);
pdf_moveto($pdf, 50, 740);
pdf_lineto($pdf, 330, 740);
pdf_stroke($pdf);
PDF_end_page($pdf);
PDF_close($pdf);
fclose($fp);
echo "&lt;A HREF=getpdf.php3&#62;finished&lt;/A&#62;";
?&#62;
    </PRE
></DIV
></TD
></TR
></TABLE
><P
>&#13;    The PHP script getpdf.php3 just outputs the pdf document.

    <DIV
CLASS="INFORMALEXAMPLE"
><P
></P
><PRE
CLASS="PROGRAMLISTING"
>&lt;?php
$fp = fopen("test.pdf", "r");
header("Content-type: application/pdf");
fpassthru($fp);
fclose($fp);
?&#62;
     </PRE
><P
></P
></DIV
>

     Doing the same with pdflib 2.0 looks like the following:

    <TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
CLASS="EXAMPLE"
><TR
><TD
><DIV
CLASS="EXAMPLE"
><P
><B
>Example 2. Creating a PDF document with pdflib 2.0</B
></P
><PRE
CLASS="PROGRAMLISTING"
>&lt;?php
$fp = fopen("test.pdf", "w");
$pdf = PDF_open($fp);
pdf_set_info_author($pdf, "Uwe Steinmann");
PDF_set_info_title($pdf, "Test for PHP wrapper of PDFlib 2.0");
PDF_set_info_author($pdf, "Name of Author");
pdf_set_info_creator($pdf, "See Author");
pdf_set_info_subject($pdf, "Testing");
PDF_begin_page($pdf, 595, 842);
PDF_add_outline($pdf, "Page 1");
pdf_set_font($pdf, "Times-Roman", 30, 4);
pdf_set_text_rendering($pdf, 1);
PDF_show_xy($pdf, "Times Roman outlined", 50, 750);
pdf_moveto($pdf, 50, 740);
pdf_lineto($pdf, 330, 740);
pdf_stroke($pdf);
PDF_end_page($pdf);
PDF_close($pdf);
fclose($fp);
echo "&lt;A HREF=getpdf.php3&#62;finished&lt;/A&#62;";
?&#62;
     </PRE
><P
>      The PHP script getpdf.php3 is the same as above.
    </P
></DIV
></TD
></TR
></TABLE
>

  The pdflib distribution contains a more complex example which
  creates a serious of pages with an analog clock. This example
  converted into PHP using pdflib 2.0 looks as the following (you
  can see the same example in the documentation for the
  <A
HREF="ref.cpdf.html"
>clibpdf module)</A
>:

    <TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
CLASS="EXAMPLE"
><TR
><TD
><DIV
CLASS="EXAMPLE"
><P
><B
>Example 3. pdfclock example from pdflib 2.0 distribution</B
></P
><PRE
CLASS="PROGRAMLISTING"
>&lt;?php
$pdffilename = "clock.pdf";
$radius = 200;
$margin = 20;
$pagecount = 40;

$fp = fopen($pdffilename, "w");
$pdf = pdf_open($fp);
pdf_set_info_creator($pdf, "pdf_clock.php3");
pdf_set_info_author($pdf, "Uwe Steinmann");
pdf_set_info_title($pdf, "Analog Clock");

while($pagecount-- &#62; 0) {
    pdf_begin_page($pdf, 2 * ($radius + $margin), 2 * ($radius + $margin));

    pdf_set_transition($pdf, 4);  /* wipe */ 
    pdf_set_duration($pdf, 0.5);
  
    pdf_translate($pdf, $radius + $margin, $radius + $margin);
    pdf_save($pdf);
    pdf_setrgbcolor($pdf, 0.0, 0.0, 1.0);

    /* minute strokes */
    pdf_setlinewidth($pdf, 2.0);
    for ($alpha = 0; $alpha &#60; 360; $alpha += 6) {
        pdf_rotate($pdf, 6.0);
        pdf_moveto($pdf, $radius, 0.0);
        pdf_lineto($pdf, $radius-$margin/3, 0.0);
        pdf_stroke($pdf);
    }

    pdf_restore($pdf);
    pdf_save($pdf);

    /* 5 minute strokes */
    pdf_setlinewidth($pdf, 3.0);
    for ($alpha = 0; $alpha &#60; 360; $alpha += 30) { 
        pdf_rotate($pdf, 30.0);
        pdf_moveto($pdf, $radius, 0.0);
        pdf_lineto($pdf, $radius-$margin, 0.0);
        pdf_stroke($pdf);
    }

    $ltime = getdate();

    /* draw hour hand */
    pdf_save($pdf);
    pdf_rotate($pdf,-(($ltime['minutes']/60.0)+$ltime['hours']-3.0)*30.0);
    pdf_moveto($pdf, -$radius/10, -$radius/20);
    pdf_lineto($pdf, $radius/2, 0.0);
    pdf_lineto($pdf, -$radius/10, $radius/20);
    pdf_closepath($pdf);
    pdf_fill($pdf);
    pdf_restore($pdf);

    /* draw minute hand */
    pdf_save($pdf);
    pdf_rotate($pdf,-(($ltime['seconds']/60.0)+$ltime['minutes']-15.0)*6.0);
    pdf_moveto($pdf, -$radius/10, -$radius/20);
    pdf_lineto($pdf, $radius * 0.8, 0.0);
    pdf_lineto($pdf, -$radius/10, $radius/20);
    pdf_closepath($pdf);
    pdf_fill($pdf);
    pdf_restore($pdf);

    /* draw second hand */
    pdf_setrgbcolor($pdf, 1.0, 0.0, 0.0);
    pdf_setlinewidth($pdf, 2);
    pdf_save($pdf);
    pdf_rotate($pdf, -(($ltime['seconds'] - 15.0) * 6.0));
    pdf_moveto($pdf, -$radius/5, 0.0);
    pdf_lineto($pdf, $radius, 0.0);
    pdf_stroke($pdf);
    pdf_restore($pdf);

    /* draw little circle at center */
    pdf_circle($pdf, 0, 0, $radius/30);
    pdf_fill($pdf);

    pdf_restore($pdf);

    pdf_end_page($pdf);
}

$pdf = pdf_close($pdf);
fclose($fp);
echo "&lt;A HREF=getpdf.php3?filename=".$pdffilename."&#62;finished&lt;/A&#62;";
?&#62;
     </PRE
><P
>      The PHP script getpdf.php3 just outputs the pdf document.
      <PRE
CLASS="PROGRAMLISTING"
>&lt;?php
$fp = fopen($filename, "r");
header("Content-type: application/pdf");
fpassthru($fp);
fclose($fp);
?&#62;
      </PRE
>
    </P
></DIV
></TD
></TR
></TABLE
>
   </P
></DIV
><DIV
CLASS="TOC"
><DL
><DT
><B
>Table of Contents</B
></DT
><DT
><A
HREF="function.pdf-get-info.html"
>PDF_get_info</A
> &#8212; Returns a default info structure for a pdf document</DT
><DT
><A
HREF="function.pdf-set-info-creator.html"
>PDF_set_info_creator</A
> &#8212; Fills the creator field of the info structure</DT
><DT
><A
HREF="function.pdf-set-info-title.html"
>PDF_set_info_title</A
> &#8212; Fills the title field of the info structure</DT
><DT
><A
HREF="function.pdf-set-info-subject.html"
>PDF_set_info_subject</A
> &#8212; Fills the subject field of the info structure</DT
><DT
><A
HREF="function.pdf-set-info-keywords.html"
>PDF_set_info_keywords</A
> &#8212; Fills the keywords field of the info structure</DT
><DT
><A
HREF="function.pdf-set-info-author.html"
>PDF_set_info_author</A
> &#8212; Fills the author field of the info structure</DT
><DT
><A
HREF="function.pdf-open.html"
>PDF_open</A
> &#8212; Opens a new pdf document</DT
><DT
><A
HREF="function.pdf-close.html"
>PDF_close</A
> &#8212; Closes a pdf document</DT
><DT
><A
HREF="function.pdf-begin-page.html"
>PDF_begin_page</A
> &#8212; Starts new page</DT
><DT
><A
HREF="function.pdf-end-page.html"
>PDF_end_page</A
> &#8212; Ends a page</DT
><DT
><A
HREF="function.pdf-show.html"
>PDF_show</A
> &#8212; Output text at current position</DT
><DT
><A
HREF="function.pdf-show-xy.html"
>PDF_show_xy</A
> &#8212; Output text at given position</DT
><DT
><A
HREF="function.pdf-set-font.html"
>PDF_set_font</A
> &#8212; Selects a font face and size</DT
><DT
><A
HREF="function.pdf-set-leading.html"
>PDF_set_leading</A
> &#8212; Sets distance between text lines</DT
><DT
><A
HREF="function.pdf-set-text-rendering.html"
>PDF_set_text_rendering</A
> &#8212; Determines how text is rendered</DT
><DT
><A
HREF="function.pdf-set-horiz-scaling.html"
>PDF_set_horiz_scaling</A
> &#8212; Sets horizontal scaling of text</DT
><DT
><A
HREF="function.pdf-set-text-rise.html"
>PDF_set_text_rise</A
> &#8212; Sets the text rise</DT
><DT
><A
HREF="function.pdf-set-text-matrix.html"
>PDF_set_text_matrix</A
> &#8212; Sets the text matrix</DT
><DT
><A
HREF="function.pdf-set-text-pos.html"
>PDF_set_text_pos</A
> &#8212; Sets text position</DT
><DT
><A
HREF="function.pdf-set-char-spacing.html"
>PDF_set_char_spacing</A
> &#8212; Sets character spacing</DT
><DT
><A
HREF="function.pdf-set-word-spacing.html"
>PDF_set_word_spacing</A
> &#8212; Sets spacing between words</DT
><DT
><A
HREF="function.pdf-continue-text.html"
>PDF_continue_text</A
> &#8212; Outputs text in next line</DT
><DT
><A
HREF="function.pdf-stringwidth.html"
>PDF_stringwidth</A
> &#8212; Returns width of text using current font</DT
><DT
><A
HREF="function.pdf-save.html"
>PDF_save</A
> &#8212; Saves the current environment</DT
><DT
><A
HREF="function.pdf-restore.html"
>PDF_restore</A
> &#8212; Restores formerly saved environment</DT
><DT
><A
HREF="function.pdf-translate.html"
>PDF_translate</A
> &#8212; Sets origin of coordinate system</DT
><DT
><A
HREF="function.pdf-scale.html"
>PDF_scale</A
> &#8212; Sets scaling</DT
><DT
><A
HREF="function.pdf-rotate.html"
>PDF_rotate</A
> &#8212; Sets rotation</DT
><DT
><A
HREF="function.pdf-setflat.html"
>PDF_setflat</A
> &#8212; Sets flatness</DT
><DT
><A
HREF="function.pdf-setlinejoin.html"
>PDF_setlinejoin</A
> &#8212; Sets linejoin parameter</DT
><DT
><A
HREF="function.pdf-setlinecap.html"
>PDF_setlinecap</A
> &#8212; Sets linecap parameter</DT
><DT
><A
HREF="function.pdf-setmiterlimit.html"
>PDF_setmiterlimit</A
> &#8212; Sets miter limit</DT
><DT
><A
HREF="function.pdf-setlinewidth.html"
>PDF_setlinewidth</A
> &#8212; Sets line width</DT
><DT
><A
HREF="function.pdf-setdash.html"
>PDF_setdash</A
> &#8212; Sets dash pattern</DT
><DT
><A
HREF="function.pdf-moveto.html"
>PDF_moveto</A
> &#8212; Sets current point</DT
><DT
><A
HREF="function.pdf-curveto.html"
>PDF_curveto</A
> &#8212; Draws a curve</DT
><DT
><A
HREF="function.pdf-lineto.html"
>PDF_lineto</A
> &#8212; Draws a line</DT
><DT
><A
HREF="function.pdf-circle.html"
>PDF_circle</A
> &#8212; Draws a circle</DT
><DT
><A
HREF="function.pdf-arc.html"
>PDF_arc</A
> &#8212; Draws an arc</DT
><DT
><A
HREF="function.pdf-rect.html"
>PDF_rect</A
> &#8212; Draws a rectangle</DT
><DT
><A
HREF="function.pdf-closepath.html"
>PDF_closepath</A
> &#8212; Closes path</DT
><DT
><A
HREF="function.pdf-stroke.html"
>PDF_stroke</A
> &#8212; Draws line along path</DT
><DT
><A
HREF="function.pdf-closepath-stroke.html"
>PDF_closepath_stroke</A
> &#8212; Closes path and draws line along path</DT
><DT
><A
HREF="function.pdf-fill.html"
>PDF_fill</A
> &#8212; Fills current path</DT
><DT
><A
HREF="function.pdf-fill-stroke.html"
>PDF_fill_stroke</A
> &#8212; Fills and strokes current path</DT
><DT
><A
HREF="function.pdf-closepath-fill-stroke.html"
>PDF_closepath_fill_stroke</A
> &#8212; Closes, fills and strokes current path</DT
><DT
><A
HREF="function.pdf-endpath.html"
>PDF_endpath</A
> &#8212; Ends current path</DT
><DT
><A
HREF="function.pdf-clip.html"
>PDF_clip</A
> &#8212; Clips to current path</DT
><DT
><A
HREF="function.pdf-setgray-fill.html"
>PDF_setgray_fill</A
> &#8212; Sets filling color to gray value</DT
><DT
><A
HREF="function.pdf-setgray-stroke.html"
>PDF_setgray_stroke</A
> &#8212; Sets drawing color to gray value</DT
><DT
><A
HREF="function.pdf-setgray.html"
>PDF_setgray</A
> &#8212; Sets drawing and filling color to gray value</DT
><DT
><A
HREF="function.pdf-setrgbcolor-fill.html"
>PDF_setrgbcolor_fill</A
> &#8212; Sets filling color to rgb color value</DT
><DT
><A
HREF="function.pdf-setrgbcolor-stroke.html"
>PDF_setrgbcolor_stroke</A
> &#8212; Sets drawing color to rgb color value</DT
><DT
><A
HREF="function.pdf-setrgbcolor.html"
>PDF_setrgbcolor</A
> &#8212; Sets drawing and filling color to rgb color value</DT
><DT
><A
HREF="function.pdf-add-outline.html"
>PDF_add_outline</A
> &#8212; Adds bookmark for current page</DT
><DT
><A
HREF="function.pdf-set-transition.html"
>PDF_set_transition</A
> &#8212; Sets transition between pages</DT
><DT
><A
HREF="function.pdf-set-duration.html"
>PDF_set_duration</A
> &#8212; Sets duration between pages</DT
><DT
><A
HREF="function.pdf-open-gif.html"
>PDF_open_gif</A
> &#8212; Opens a GIF image</DT
><DT
><A
HREF="function.pdf-open-memory-image.html"
>PDF_open_memory_image</A
> &#8212; Opens an image created with PHP's image functions</DT
><DT
><A
HREF="function.pdf-open-jpeg.html"
>PDF_open_jpeg</A
> &#8212; Opens a JPEG image</DT
><DT
><A
HREF="function.pdf-close-image.html"
>PDF_close_image</A
> &#8212; Closes an image</DT
><DT
><A
HREF="function.pdf-place-image.html"
>PDF_place_image</A
> &#8212; Places an image on the page</DT
><DT
><A
HREF="function.pdf-put-image.html"
>PDF_put_image</A
> &#8212; Stores an image in the PDF for later use</DT
><DT
><A
HREF="function.pdf-execute-image.html"
>PDF_execute_image</A
> &#8212; Places a stored image on the page</DT
></DL
></DIV
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="pcre.pattern.syntax.html"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="manual.html"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="function.pdf-get-info.html"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Pattern Syntax</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="funcref.html"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>PDF_get_info</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>
<HTML
><HEAD
><TITLE
>Encryption functions</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.41"><LINK
REL="HOME"
TITLE="PHP3 Manual"
HREF="manual.html"><LINK
REL="UP"
TITLE="Function Reference"
HREF="funcref.html"><LINK
REL="PREVIOUS"
TITLE="Tan"
HREF="function.tan.html"><LINK
REL="NEXT"
TITLE="mcrypt_get_cipher_name"
HREF="function.mcrypt-get-cipher-name.html"></HEAD
><BODY
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#0000FF"
VLINK="#840084"
ALINK="#0000FF"
><DIV
CLASS="NAVHEADER"
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>PHP3 Manual</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="function.tan.html"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
></TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="function.mcrypt-get-cipher-name.html"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="REFERENCE"
><A
NAME="REF.MCRYPT"
></A
><DIV
CLASS="TITLEPAGE"
><H1
CLASS="TITLE"
>XXVIII. Encryption functions</H1
><DIV
CLASS="PARTINTRO"
><A
NAME="AEN13296"
></A
><P
>    These functions work using <A
HREF="ftp://argeas.cs-net.gr/pub/unix/mcrypt/"
TARGET="_top"
>mcrypt</A
>.

   </P
><P
>    This is an interface to the mcrypt library, which supports a wide
    variety of block algorithms such as DES, TripleDES, Blowfish
    (default), 3-WAY, SAFER-SK64, SAFER-SK128, TWOFISH, TEA, RC2 and
    GOST in CBC, OFB, CFB and ECB cipher modes. Additionally, it
    supports RC6 and IDEA which are considered "non-free".

   </P
><P
>    To use it, download libmcrypt-x.x.tar.gz from <A
HREF="ftp://argeas.cs-net.gr/pub/unix/mcrypt/"
TARGET="_top"
>here</A
> and follow the included
    installation instructions. You need to compile PHP with the <TT
CLASS="OPTION"
>--with-mcrypt</TT
> parameter to enable this
    extension.

   </P
><P
>    mcrypt can be used to encrypt and decrypt using the above
    mentioned ciphers. The four important mcrypt commands
    (<A
HREF="function.mcrypt-cfb.html"
><B
CLASS="FUNCTION"
>mcrypt_cfb()</B
></A
>, <A
HREF="function.mcrypt-cbc.html"
><B
CLASS="FUNCTION"
>mcrypt_cbc()</B
></A
>,
    <A
HREF="function.mcrypt-ecb.html"
><B
CLASS="FUNCTION"
>mcrypt_ecb()</B
></A
>, and
    <A
HREF="function.mcrypt-ofb.html"
><B
CLASS="FUNCTION"
>mcrypt_ofb()</B
></A
>) can operate in both modes which
    are named MCRYPT_ENCRYPT and MCRYPT_DECRYPT, respectively.
    
    <TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
CLASS="EXAMPLE"
><TR
><TD
><DIV
CLASS="EXAMPLE"
><P
><B
>Example 1. Encrypt an input value with TripleDES in ECB mode</B
></P
><PRE
CLASS="PROGRAMLISTING"
>&lt;?php
$key = "this is a very secret key";
$input = "Let us meet at 9 o'clock at the secret place.";

$encrypted_data = mcrypt_ecb(MCRYPT_TripleDES, $key, $input, MCRYPT_ENCRYPT);
?&gt;
     </PRE
></DIV
></TD
></TR
></TABLE
>
	  
    This example will give you the encrypted data as a string in
    $encrypted_data. 

   </P
><P
>    mcrypt can operate in four cipher modes (CBC, OFB, CFB, and ECB). We will
    outline the normal use for each of these modes. For a more complete
    reference and discussion see Applied Cryptography by Schneier (ISBN 0-471-11709-9).

    <P
></P
><UL
><LI
><P
>      ECB (electronic codebook) is suitable for random data, such as encrypting
      other keys. Since data there is short and random, the disadvantages of
      ECB have a favorable negative effect.

     </P
></LI
><LI
><P
>      CBC (cipher block chaining) is especially suitable for encrypting files
      where the security is increased over ECB significantly. 

     </P
></LI
><LI
><P
>      CFB (cipher feedback) is the best mode for encrypting byte streams where
      single bytes must be encrypted.

     </P
></LI
><LI
><P
>      OFB (output feedback) is comparable to CFB, but can be used in
      applications where error propagation cannot be tolerated. 
    </P
></LI
></UL
>
    
   </P
><P
>    PHP does not support encrypting/decrypting bit streams currently. As of
    now, PHP only supports handling of strings.

   </P
><P
>    For a complete list of supported ciphers, see the defines at the end of
    mcrypt.h. The general rule is that you can access the cipher from PHP with
    MCRYPT_ciphername. 
   
   </P
><P
>    Here is a short list of ciphers which are currently supported by the
    mcrypt extension. If a cipher is not listed here, but is listed by
    mcrypt as supported, you can safely assume that this documentation
    is outdated.

    <P
></P
><UL
><LI
><P
>      MCRYPT_BLOWFISH
     </P
></LI
><LI
><P
>      MCRYPT_DES
     </P
></LI
><LI
><P
>      MCRYPT_TripleDES
     </P
></LI
><LI
><P
>      MCRYPT_ThreeWAY
     </P
></LI
><LI
><P
>      MCRYPT_GOST
     </P
></LI
><LI
><P
>      MCRYPT_CRYPT
     </P
></LI
><LI
><P
>      MCRYPT_DES_COMPAT
     </P
></LI
><LI
><P
>      MCRYPT_SAFER64
     </P
></LI
><LI
><P
>      MCRYPT_SAFER128
     </P
></LI
><LI
><P
>      MCRYPT_CAST128
     </P
></LI
><LI
><P
>      MCRYPT_TEAN
     </P
></LI
><LI
><P
>      MCRYPT_RC2
     </P
></LI
><LI
><P
>      MCRYPT_TWOFISH (for older mcrypt 2.x versions)
     </P
></LI
><LI
><P
>      MCRYPT_TWOFISH128 (TWOFISHxxx are available in newer 2.x versions)
     </P
></LI
><LI
><P
>      MCRYPT_TWOFISH192
     </P
></LI
><LI
><P
>      MCRYPT_TWOFISH256
     </P
></LI
><LI
><P
>      MCRYPT_RC6
     </P
></LI
><LI
><P
>      MCRYPT_IDEA

    </P
></LI
></UL
>

   </P
><P
>    You must (in CFB and OFB mode) or can (in CBC mode) supply an
    initialization vector (IV) to the respective cipher function. The IV must
    be unique and must be the same when decrypting/encrypting. With data which
    is stored encrypted, you can take the output of a function of the index
    under which the data is stored (e.g.  the MD5 key of the filename).
    Alternatively, you can transmit the IV together with the encrypted data
    (see chapter 9.3 of Applied Cryptography by Schneier (ISBN 0-471-11709-9) for a discussion of this
    topic).

  </P
></DIV
><DIV
CLASS="TOC"
><DL
><DT
><B
>Table of Contents</B
></DT
><DT
><A
HREF="function.mcrypt-get-cipher-name.html"
>mcrypt_get_cipher_name</A
> &#8212; Get the name of the specified cipher</DT
><DT
><A
HREF="function.mcrypt-get-block-size.html"
>mcrypt_get_block_size</A
> &#8212; Get the block size of the specified cipher</DT
><DT
><A
HREF="function.mcrypt-get-key-size.html"
>mcrypt_get_key_size</A
> &#8212; Get the key size of the specified cipher</DT
><DT
><A
HREF="function.mcrypt-create-iv.html"
>mcrypt_create_iv</A
> &#8212; Create an initialization vector (IV) from a random source</DT
><DT
><A
HREF="function.mcrypt-cbc.html"
>mcrypt_cbc</A
> &#8212; Encrypt/decrypt data in CBC mode</DT
><DT
><A
HREF="function.mcrypt-cfb.html"
>mcrypt_cfb</A
> &#8212; Encrypt/decrypt data in CFB mode</DT
><DT
><A
HREF="function.mcrypt-ecb.html"
>mcrypt_ecb</A
> &#8212; Encrypt/decrypt data in ECB mode</DT
><DT
><A
HREF="function.mcrypt-ofb.html"
>mcrypt_ofb</A
> &#8212; Encrypt/decrypt data in OFB mode</DT
></DL
></DIV
></DIV
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="function.tan.html"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="manual.html"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="function.mcrypt-get-cipher-name.html"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Tan</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="funcref.html"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>mcrypt_get_cipher_name</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>